pod-privileged-protect-mode:
  url: ghcr.io/kubewarden/tests/pod-privileged:v0.2.1
  policyMode: protect
  allowedToMutate: false
  settings: {}

pod-privileged-monitor-mode:
  url: ghcr.io/kubewarden/tests/pod-privileged:v0.2.1
  policyMode: monitor
  allowedToMutate: false
  settings: {}

sleep:
  url: ghcr.io/kubewarden/tests/sleeping-policy:v0.1.0
  policyMode: protect
  allowedToMutate: false
  settings:
    sleepMilliseconds: 2000

disallow-service-loadbalancer:
  url: ghcr.io/kubewarden/tests/disallow-service-loadbalancer:v0.1.5
  policyMode: protect
  allowedToMutate: false

flux:
  url: ghcr.io/kubewarden/tests/go-wasi-template:v0.1.0
  policyMode: protect
  allowedToMutate: true
  settings:
    requiredAnnotations:
      "fluxcd.io/cat": "felix"

raw-validation:
  url: ghcr.io/kubewarden/tests/raw-validation-policy:v0.1.0
  settings:
    validUsers:
      - "tonio"
      - "wanda"
    validActions:
      - "eats"
      - "likes"
    validResources:
      - "banana"
      - "hay"

raw-mutation:
  url: ghcr.io/kubewarden/tests/raw-mutation-policy:v0.1.0
  allowedToMutate: true
  settings:
    forbiddenResources:
      - "banana"
      - "carrot"
    defaultResource: "hay"

raw-validation-opa:
  url: ghcr.io/kubewarden/tests/raw-validation-opa-policy:v0.1.0
  settings: {}

raw-validation-wasi:
  url: ghcr.io/kubewarden/tests/raw-validation-wasi-policy:v0.1.0
  settings:
    validUsers:
      - "tonio"
      - "wanda"
    validActions:
      - "eats"
      - "likes"
    validResources:
      - "banana"
      - "hay"

raw-mutation-wasi:
  url: ghcr.io/kubewarden/tests/raw-mutation-wasi-policy:v0.1.0
  allowedToMutate: true
  settings:
    forbiddenResources:
      - "banana"
      - "carrot"
    defaultResource: "hay"

apparmor:
  url: ghcr.io/kubewarden/tests/apparmor-psp:v0.1.13
  allowedToMutate: false
  settings:
    allowed_profiles:
      - runtime/default

psp-user-group:
  url: ghcr.io/kubewarden/tests/user-group-psp:v0.4.9
  allowedToMutate: true
  settings:
    run_as_user:
      rule: MustRunAs
      ranges:
        - min: 1000
          max: 2000
    run_as_group:
      rule: RunAsAny
      overwrite: false
    supplemental_groups:
      rule: RunAsAny
      overwrite: false
