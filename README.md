# Kubewarden
This is a monorepo for Kubewarden projects. And it has been generated by the following script:
```bash
#!/bin/bash
set -ex

pushd .

# clean previous runs
rm -rf kubewarden-monorepo /tmp/policy-fetcher /tmp/policy-evaluator /tmp/kwctl /tmp/policy-server /tmp/kubewarden-controller

# create/fetch directories and code
mkdir kubewarden-monorepo

# init monorepo
echo "# Kubewarden" > kubewarden-monorepo/README.md
echo "This is a monorepo for Kubewarden projects. And it has been generated by the following script:" >> kubewarden-monorepo/README.md
{
  echo '```bash'
  cat -- "$(realpath -e -- "$0" || echo "$0")"
  echo '```'
} >> kubewarden-monorepo/README.md
cd kubewarden-monorepo
git init
git branch -m main
git add README.md
git commit -s -m "Initial commit"

# clone repositories to be merged
git clone git@github.com:kubewarden/policy-fetcher.git /tmp/policy-fetcher
git clone git@github.com:kubewarden/policy-evaluator.git /tmp/policy-evaluator
git clone git@github.com:kubewarden/kwctl.git /tmp/kwctl
git clone git@github.com:kubewarden/policy-server.git /tmp/policy-server
git clone git@github.com:kubewarden/kubewarden-controller.git /tmp/kubewarden-controller

# move repository code to subdirectories
pushd .
cd /tmp/policy-fetcher
git filter-repo --to-subdirectory-filter policy-fetcher
cd /tmp/policy-evaluator
git filter-repo --to-subdirectory-filter policy-evaluator
cd /tmp/policy-server
git filter-repo --to-subdirectory-filter policy-server
cd /tmp/kwctl
git filter-repo --to-subdirectory-filter kwctl
cd /tmp/kubewarden-controller
git filter-repo --to-subdirectory-filter kubewarden-controller
popd

# back to the monorepo to add the repositories code
git remote add -f policy-fetcher /tmp/policy-fetcher
git merge --allow-unrelated-histories -m "Merge policy-fetcher repository into monorepo" policy-fetcher/main

git remote add -f policy-evaluator /tmp/policy-evaluator
git merge --allow-unrelated-histories -m "Merge policy-evaluator repository into monorepo" policy-evaluator/main

git remote add -f kwctl /tmp/kwctl
git merge --allow-unrelated-histories -m "Merge kwctl repository into monorepo" kwctl/main

git remote add -f policy-server /tmp/policy-server
git merge --allow-unrelated-histories -m "Merge policy-server repository into monorepo" policy-server/main

git remote add -f kubewarden-controller /tmp/kubewarden-controller
git merge --allow-unrelated-histories -m "Merge kubewarden-controller repository into monorepo" kubewarden-controller/main

# push monorepo to GitHub
git remote add origin git@github.com:jvanz/kubewarden-filter-repo-testing.git
git push --force origin main

popd
```
